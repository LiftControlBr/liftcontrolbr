<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Checklist Digital – Lift Control - Com PDF multipage</title>

<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 30px;
    background-color: #376899;
    color: #f0f5fa;
  }
  form {
    max-width: 820px;
    margin: 0 auto;
    background-color: #ffffff;
    border-radius: 14px;
    padding: 45px 35px;
    box-shadow: 0 10px 35px #112f52a0;
    color: #0c2340;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
    color: #072a56;
  }
  label {
    margin-top: 20px;
    display: block;
    font-size: 16px;
    font-weight: 600;
    color: #072a56;
  }
  input[type=text], input[type=email], input[type=number], input[type=date], select, textarea {
    width: 100%;
    max-width: 100%;
    padding: 12px 12px;
    font-size: 15px;
    border-radius: 8px;
    border: 1.5px solid #ccd7e0;
    margin-top: 8px;
    color: #072a56;
    font-weight: 500;
    box-sizing: border-box;
  }
  input[type=text]:focus, input[type=email]:focus, input[type=number]:focus, input[type=date]:focus, select:focus, textarea:focus {
    border-color: #2a65ad;
    outline: none;
  }
  textarea {
    min-height: 110px;
    resize: vertical;
  }
  .checklist-section {
    margin-top: 35px;
    font-size: 14pt;
  }
  .checklist-section h2 {
    border-bottom: 3px solid #2a65ad;
    margin-bottom: 20px;
    color: #2a65ad;
    font-weight: 700;
  }
  label.check-item {
    display: flex;
    align-items: center;
    padding: 12px 18px;
    background-color: #e8eef6;
    margin-bottom: 16px;
    border-radius: 12px;
    cursor: pointer;
    user-select: none;
    font-weight: 600;
    font-size: 16pt;
    color: #104080;
    transition: background-color 0.3s;
  }
  label.check-item:hover {
    background-color: #d7e1f5;
  }
  label.check-item input[type="checkbox"] {
    margin-right: 15px;
    width: 26px;
    height: 26px;
    cursor: pointer;
    flex-shrink: 0;
  }
  .buttons {
    margin-top: 30px;
    display: flex;
    justify-content: center;
    gap: 30px;
    flex-wrap: wrap;
  }
  button {
    padding: 15px 50px;
    font-size: 18pt;
    font-weight: 700;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
    background-color: #2a65ad;
    color: white;
    box-shadow: 0 5px 15px rgba(42, 101, 173, 0.7);
  }
  button:hover {
    background-color: #184a6e;
  }
  @media (max-width: 600px) {
    form {
      padding: 25px 20px;
    }
    button {
      width: 100%;
      padding: 20px 0;
      font-size: 20pt;
    }
    .buttons {
      flex-direction: column;
      gap: 20px;
      align-items: stretch;
    }
  }
  .required {
    color: #dd4b39;
    margin-left: 3px;
  }
</style>
</head>
<body>
<form id="checklistForm" novalidate>
  <h1>Checklist Digital – Lift Control</h1>

  <label for="nomeCondominio">Nome do Condomínio <span class="required">*</span></label>
  <input id="nomeCondominio" name="nomeCondominio" type="text" required placeholder="Ex: Edifício Solaris" autocomplete="off" />

  <label for="endereco">Endereço Completo <span class="required">*</span></label>
  <input id="endereco" name="endereco" type="text" required autocomplete="off" />

  <label for="totalElevadores">Total de Elevadores no Prédio <span class="required">*</span></label>
  <input id="totalElevadores" name="totalElevadores" type="number" min="1" required autocomplete="off" />

  <label for="elevadorInspecionado">Elevador Inspecionado <span class="required">*</span></label>
  <select id="elevadorInspecionado" name="elevadorInspecionado" required>
    <option value="" disabled selected>Selecione...</option>
    <option>Social</option>
    <option>Serviço</option>
    <option>Elevador 1</option>
    <option>Elevador 2</option>
    <option>Elevador 3</option>
  </select>

  <label for="emailCondominio">Email do Condomínio <span class="required">*</span></label>
  <input id="emailCondominio" name="emailCondominio" type="email" required placeholder="contato@condominio.com" autocomplete="off" />

  <label for="telefoneResponsavel">Telefone do Responsável <span class="required">*</span></label>
  <input id="telefoneResponsavel" name="telefoneResponsavel" type="text" placeholder="(13) 99999-9999" pattern="^\(?\d{2}\)?\s?\d{4,5}-?\d{4}$" required autocomplete="off" title="Formato esperado: (13) 99999-9999" />

  <label for="dataManutencao">Data da Manutenção <span class="required">*</span></label>
  <input id="dataManutencao" name="dataManutencao" type="date" required />

  <label for="tipoManutencao">Tipo de Manutenção <span class="required">*</span></label>
  <select id="tipoManutencao" name="tipoManutencao" required>
    <option value="" disabled selected>Selecione...</option>
    <option>Preventiva</option>
    <option>Corretiva</option>
    <option>Emergencial</option>
  </select>

  <label for="nomeTecnico">Nome Completo do Técnico <span class="required">*</span></label>
  <input id="nomeTecnico" name="nomeTecnico" type="text" required placeholder="Nome completo" autocomplete="off" />

  <label for="empresaTecnico">Empresa do Técnico <span class="required">*</span></label>
  <input id="empresaTecnico" name="empresaTecnico" type="text" required autocomplete="off" />

  <label for="registroTecnico">CREA / Registro Profissional</label>
  <input id="registroTecnico" name="registroTecnico" type="text" autocomplete="off" />

  <div class="checklist-section">
    <h2>Casa de Máquinas</h2>
    <label class="check-item"><input type="checkbox" name="motor" /> Motor de tração - Estado geral</label>
    <label class="check-item"><input type="checkbox" name="freio" /> Freio eletromagnético - Funcionamento</label>
    <label class="check-item"><input type="checkbox" name="redutor" /> Redutor - Nível de óleo / ruídos</label>
    <label class="check-item"><input type="checkbox" name="quadro" /> Quadro de comando - Limpeza / conexões</label>
    <label class="check-item"><input type="checkbox" name="limitador" /> Limitador de velocidade - Teste</label>
    <label class="check-item"><input type="checkbox" name="cabos" /> Cabos de tração - Desgaste / lubrificação</label>
    <label class="check-item"><input type="checkbox" name="polias" /> Polias - Estado / alinhamento</label>
    <label class="check-item"><input type="checkbox" name="ventilacao" /> Ventilação da casa de máquinas</label>
    <label class="check-item"><input type="checkbox" name="iluminacaoEmergencia" /> Iluminação de emergência</label>
    <label class="check-item"><input type="checkbox" name="limpeza" /> Limpeza geral do ambiente</label>
  </div>

  <div class="checklist-section">
    <h2>Cabina</h2>
    <label class="check-item"><input type="checkbox" name="portas" /> Portas - Abertura / fechamento</label>
    <label class="check-item"><input type="checkbox" name="botoes" /> Botões - Funcionamento</label>
    <label class="check-item"><input type="checkbox" name="display" /> Display / Indicadores</label>
    <label class="check-item"><input type="checkbox" name="iluminacaoInterna" /> Iluminação interna</label>
    <label class="check-item"><input type="checkbox" name="ventilacaoCabina" /> Ventilação / Exaustor</label>
    <label class="check-item"><input type="checkbox" name="interfone" /> Interfone / Alarme</label>
    <label class="check-item"><input type="checkbox" name="espelho" /> Espelho / Acabamentos</label>
    <label class="check-item"><input type="checkbox" name="piso" /> Piso / Nivelamento</label>
  </div>

  <div class="checklist-section">
    <h2>Poço</h2>
    <label class="check-item"><input type="checkbox" name="amortecedores" /> Amortecedores - Estado</label>
    <label class="check-item"><input type="checkbox" name="limpezaPoco" /> Limpeza do poço</label>
    <label class="check-item"><input type="checkbox" name="drenagem" /> Drenagem de água</label>
    <label class="check-item"><input type="checkbox" name="iluminacaoPoco" /> Iluminação</label>
    <label class="check-item"><input type="checkbox" name="cabosEletricos" /> Cabos elétricos - Fixação</label>
  </div>

  <label for="reparosExecutados" style="margin-top: 30px;">Reparos Executados <span class="required">*</span></label>
  <textarea id="reparosExecutados" name="reparosExecutados" minlength="10" required placeholder="Descreva detalhadamente os reparos..."></textarea>

  <label for="observacoes" style="margin-top: 20px;">Observações / Recomendações</label>
  <textarea id="observacoes" name="observacoes" placeholder="Observações importantes ou recomendações"></textarea>

  <div class="buttons">
    <button type="submit">Gerar PDF</button>
  </div>
</form>

<script>
  document.getElementById('checklistForm').addEventListener('submit', async e => {
    e.preventDefault();

    if (!e.target.checkValidity()) {
      alert('Por favor, preencha todos os campos obrigatórios corretamente.');
      e.target.reportValidity();
      return;
    }

    try {
      const dados = {};
      new FormData(e.target).forEach((value, key) => {
        dados[key] = value;
      });

      ['motor','freio','redutor','quadro','limitador','cabos','polias','ventilacao','iluminacaoEmergencia','limpeza',
          'portas','botoes','display','iluminacaoInterna','ventilacaoCabina','interfone','espelho','piso',
          'amortecedores','limpezaPoco','drenagem','iluminacaoPoco','cabosEletricos'].forEach(id => {
        const el = e.target.elements[id];
        dados[id] = el && el.checked ? "Ok" : "Pendente";
      });

      const content = `
        <div style="font-family: Arial, sans-serif; padding: 20px; color: #223151; font-size: 18pt; line-height: 1.6;">
          <h2 style="text-align:center; font-weight: 700; font-size: 22pt; color: #223151;">
            Checklist Digital – Lift Control
          </h2>
          <hr style="border-color: #bbbcbe; margin: 10px 0 30px 0;" />
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-bottom: 10px;">Dados do Condomínio</h3>
          <p><strong style="color: #223151;">Nome:</strong> ${dados.nomeCondominio}</p>
          <p><strong style="color: #223151;">Endereço:</strong> ${dados.endereco}</p>
          <p><strong style="color: #223151;">Total de Elevadores:</strong> ${dados.totalElevadores}</p>
          <p><strong style="color: #223151;">Elevador Inspecionado:</strong> ${dados.elevadorInspecionado}</p>
          <p><strong style="color: #223151;">Email:</strong> ${dados.emailCondominio}</p>
          <p><strong style="color: #223151;">Telefone:</strong> ${dados.telefoneResponsavel}</p>
          <hr style="border-color: #bbbcbe; margin: 30px 0;" />
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-bottom: 10px;">Manutenção</h3>
          <p><strong style="color: #223151;">Data:</strong> ${dados.dataManutencao}</p>
          <p><strong style="color: #223151;">Tipo:</strong> ${dados.tipoManutencao}</p>
          <p><strong style="color: #223151;">Técnico:</strong> ${dados.nomeTecnico}</p>
          <p><strong style="color: #223151;">Empresa:</strong> ${dados.empresaTecnico}</p>
          <p><strong style="color: #223151;">Registro:</strong> ${dados.registroTecnico || 'N/A'}</p>
          <hr style="border-color: #bbbcbe; margin: 30px 0;" />
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-bottom: 10px;">Casa de Máquinas</h3>
          <ul>
            <li>Motor de tração: ${dados.motor}</li>
            <li>Freio eletromagnético: ${dados.freio}</li>
            <li>Redutor: ${dados.redutor}</li>
            <li>Quadro de comando: ${dados.quadro}</li>
            <li>Limitador de velocidade: ${dados.limitador}</li>
            <li>Cabos de tração: ${dados.cabos}</li>
            <li>Polias: ${dados.polias}</li>
            <li>Ventilação: ${dados.ventilacao}</li>
            <li>Iluminação de emergência: ${dados.iluminacaoEmergencia}</li>
            <li>Limpeza geral: ${dados.limpeza}</li>
          </ul>
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-top: 30px; margin-bottom: 10px;">Cabina</h3>
          <ul>
            <li>Portas: ${dados.portas}</li>
            <li>Botões: ${dados.botoes}</li>
            <li>Display / Indicadores: ${dados.display}</li>
            <li>Iluminação interna: ${dados.iluminacaoInterna}</li>
            <li>Ventilação / Exaustor: ${dados.ventilacaoCabina}</li>
            <li>Interfone / Alarme: ${dados.interfone}</li>
            <li>Espelho / Acabamentos: ${dados.espelho}</li>
            <li>Piso / Nivelamento: ${dados.piso}</li>
          </ul>
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-top: 30px; margin-bottom: 10px;">Poço</h3>
          <ul>
            <li>Amortecedores: ${dados.amortecedores}</li>
            <li>Limpeza do poço: ${dados.limpezaPoco}</li>
            <li>Drenagem de água: ${dados.drenagem}</li>
            <li>Iluminação: ${dados.iluminacaoPoco}</li>
            <li>Cabos elétricos: ${dados.cabosEletricos}</li>
          </ul>
          <hr style="border-color: #bbbcbe; margin: 30px 0;" />
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-bottom: 10px;">Reparos Executados</h3>
          <p style="font-size: 16pt;">${dados.reparosExecutados}</p>
          <h3 style="font-weight: 700; font-size: 18pt; color: #223151; margin-top: 30px; margin-bottom: 10px;">Observações / Recomendações</h3>
          <p style="font-size: 16pt;">${dados.observacoes || ''}</p>
          <hr style="border-color: #bbbcbe; margin-top: 30px;" />
          <p style="font-size: 14pt; color: #777; text-align: center;">Gerado por Lift Control - 2025</p>
        </div>`;

      const container = document.createElement('div');
      container.style.width = '900px';
      container.style.padding = "20px";
      container.style.background = "white";
      container.innerHTML = content;
      document.body.appendChild(container);

      html2canvas(container, { scale: 3, scrollY: -window.scrollY }).then(canvasImg => {
        const imgData = canvasImg.toDataURL('image/png');
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'pt', 'a4');
        const pdfWidth = pdf.internal.pageSize.getWidth() - 40;
        const pdfHeight = (canvasImg.height * pdfWidth) / canvasImg.width;
        // Multi-page handling
        let heightLeft = pdfHeight;
        let position = 20;

        pdf.addImage(imgData, 'PNG', 20, position, pdfWidth, pdfHeight);
        heightLeft -= pdf.internal.pageSize.getHeight() - 40;

        while (heightLeft > 0) {
          pdf.addPage();
          position = heightLeft - pdfHeight + 20;
          pdf.addImage(imgData, 'PNG', 20, position, pdfWidth, pdfHeight);
          heightLeft -= pdf.internal.pageSize.getHeight() - 40;
        }

        pdf.save(`Checklist_${dados.nomeCondominio.replace(/\s+/g, "")}_${dados.elevadorInspecionado.replace(/\s+/g, "")}.pdf`);
        document.body.removeChild(container);
      });
    } catch (e) {
      alert("Erro ao gerar PDF:\n" + e);
    }
  });
</script>
</body>
</html>
